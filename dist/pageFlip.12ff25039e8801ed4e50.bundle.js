!function(t){var e={};function i(a){if(e[a])return e[a].exports;var s=e[a]={i:a,l:!1,exports:{}};return t[a].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=e,i.d=function(t,e,a){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(a,s,function(e){return t[e]}.bind(null,s));return a},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i(1),s=function(){function t(t){this.pageWidth=0,this.pageHeight=0,this.canvasPaddingHorizontal=10,this.canvasPaddingVeritical=20,this.flipSpeed=.34,this.flipMoveSpeed=.5,this.flipStrength=10,this.flipColor="#fff",this._pages=[],this._pageIndex=0,this.mousePos={x:0,y:0},this.flips=[],this.startX=0,this.startTime=0,this.touchDragging=!1,this.enable=!0,this.book=t.book,this.pages=Array.from(t.pages),this.flipSpeed=t.flipSpeed||this.flipSpeed,this.flipMoveSpeed=t.flipMoveSpeed||this.flipSpeed,this.flipColor=t.flipColor||this.flipColor,this.onFlipComplete=t.onFlipComplete||this.onFlipComplete,this.init()}return Object.defineProperty(t.prototype,"pages",{get:function(){return Array.from(this._pages)},set:function(t){this._pages=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageIndex",{get:function(){return this._pageIndex},set:function(t){var e;try{this.onFlipComplete&&(e=this.onFlipComplete).call.apply(e,[{}].concat([t+1,this.pageIndex+1]))}catch(t){console.log(t)}this._pageIndex=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isDragging",{get:function(){return this.touchDragging},enumerable:!0,configurable:!0}),t.prototype.render=function(){var t=this;this.canvasContext.clearRect(0,0,this.canvas.width,this.canvas.height),this.flips.forEach(function(e){e.dragging&&(e.target=Math.max(Math.min(t.mousePos.x/t.pageWidth,1),-1)),e.progress+=(e.target-e.progress)*Math.max(Math.min(t.flipSpeed,1),0),(e.dragging||Math.abs(e.progress)<.997)&&t.drawFlip(e)})},t.prototype.bindEvent=function(){var t=this;document.addEventListener("touchstart",function(e){t.drapDwon(e)},!1),document.addEventListener("touchmove",function(e){t.drapMove(e)},!1),document.addEventListener("touchend",function(e){t.drapRelease(e)},!1)},t.prototype.drapDwon=function(t){this.startX=t.touches[0].clientX,this.startTime=(new Date).getTime()},t.prototype.drapMove=function(t){var e,i;if(t.touches){var s=t.touches[0];e=s.clientX,i=s.clientY}if(this.enable)if(this.touchDragging)this.setMousePos(e,i);else{var n=e-this.startX;if(this.touchDragging=Math.abs(n)>=20,!this.touchDragging)return;var o=this.pageIndex+(n>0?-1:0),r=this.flips[o];if(!r)return void this.drapRelease(t);if(n<0&&o===this.flips.length-1)return void this.drapRelease(t);this.currentDireciton=n>0?a.DirectionType.LEFT:a.DirectionType.RIGHT,r.dragging=!0}},t.prototype.drapRelease=function(t){var e=this.flips.find(function(t){return t.dragging}),i=null;if(this.touchDragging=!1,e){var s=(t.touches[0]||t.changedTouches[0]).clientX,n=(new Date).getTime();Math.abs((s-this.startX)/(n-this.startTime))>this.flipMoveSpeed&&(i=s-this.startX>0?1:-1),i||(i=this.mousePos.x>=this.pageWidth/2?1:-1),-1===i?(e.target=-1,this.currentDireciton===a.DirectionType.RIGHT?this.pageIndex=Math.min(this.pageIndex+1,this.flips.length-1):this.pageIndex=this.pageIndex):1===i&&(e.target=1,this.currentDireciton===a.DirectionType.LEFT?this.pageIndex=Math.max(this.pageIndex-1,0):this.pageIndex=this.pageIndex),e.dragging=!1}},t.prototype.setMousePos=function(t,e){this.mousePos.x=t-this.book.offsetLeft,this.mousePos.y=-e+this.book.offsetTop+this.pageHeight},t.prototype.drawFlip=function(t){var e=1-Math.abs(t.progress),i=this.pageWidth/2*(1-t.progress),a=this.pageWidth*t.progress+i,s=this.flipStrength*e,n=.5*this.pageWidth*Math.max(Math.min(1-t.progress,.5),0),o=.5*this.pageWidth*Math.max(Math.min(e,.5),0),r=.5*this.pageWidth*Math.max(Math.min(e,.5),0);t.page.style.transform="translate3D("+(a-this.pageWidth)+"px,0,0)",t.pageWrapper.style.transform="translate3D("+(this.pageWidth-a)+"px,0,0)",this.canvasContext.save(),this.canvasContext.translate(this.canvasPaddingHorizontal+0,this.canvasPaddingVeritical),this.canvasContext.strokeStyle="rgba(0,0,0,"+.05*e+")",this.canvasContext.lineWidth=30*e,this.canvasContext.beginPath(),this.canvasContext.moveTo(a-i,.5*-s),this.canvasContext.lineTo(a-i,this.pageHeight+.5*s),this.canvasContext.stroke();var h=this.canvasContext.createLinearGradient(a,0,a+o,0);h.addColorStop(0,"rgba(0,0,0,"+.2*e+")"),h.addColorStop(.8,"rgba(0,0,0,0.0)"),this.canvasContext.fillStyle=h,this.canvasContext.beginPath(),this.canvasContext.moveTo(a,0),this.canvasContext.lineTo(a+o,0),this.canvasContext.lineTo(a+o,this.pageHeight),this.canvasContext.lineTo(a,this.pageHeight),this.canvasContext.fill();var p=this.canvasContext.createLinearGradient(a-i-r,0,a-i,0);p.addColorStop(0,"rgba(0,0,0,0.0)"),p.addColorStop(1,"rgba(0,0,0,"+.15*e+")"),this.canvasContext.fillStyle=p,this.canvasContext.beginPath(),this.canvasContext.moveTo(a-i-r,0),this.canvasContext.lineTo(a-i,0),this.canvasContext.lineTo(a-i,this.pageHeight),this.canvasContext.lineTo(a-i-r,this.pageHeight),this.canvasContext.fill();var l=this.canvasContext.createLinearGradient(a-n,0,a,0);l.addColorStop(.35,"#fafafa"),l.addColorStop(.73,"#eeeeee"),l.addColorStop(.9,"#fafafa"),l.addColorStop(1,"#e2e2e2"),this.canvasContext.fillStyle=l,this.canvasContext.strokeStyle="rgba(0,0,0,0.06)",this.canvasContext.lineWidth=.5,this.canvasContext.beginPath(),this.canvasContext.moveTo(a,0),this.canvasContext.lineTo(a,this.pageHeight),this.canvasContext.quadraticCurveTo(a,this.pageHeight+2*s,a-i,this.pageHeight+s),this.canvasContext.lineTo(a-i,-s),this.canvasContext.quadraticCurveTo(a,2*-s,a,0),this.canvasContext.fill(),this.canvasContext.stroke(),this.canvasContext.restore()},t.prototype.runRender=function(){var t=this;this.render(),requestAnimationFrame(function(){t.runRender()})},t.prototype.turnToPage=function(t,e){var i=this;this.pages[t-1]&&this.pageIndex!==t-1&&((this.flips||[]).forEach(function(e,a){var s=e.page,n=e.pageWrapper;a<t-1?(s.style.transform="translate3D("+-i.pageWidth+"px,0,0)",n.style.transform="translate3D("+i.pageWidth+"px,0,0)",i.flips[a].target=-1,i.flips[a].progress=-1):(s.style.transform="translate3D(0,0,0)",n.style.transform="translate3D(0,0,0)")}),e&&(t-1>this.pageIndex?this.flips[this.pageIndex].target=-1:this.flips[this.pageIndex-1].target=1),this._pageIndex=t-1)},t.prototype.enbleFlip=function(){this.enable=!0},t.prototype.disableFlip=function(){this.enable=!1},t.prototype.resetPages=function(t){this._pageIndex=0,this.pages=Array.from(t),this.initFlips()},t.prototype.resetPageSize=function(){var t=this;this.canvas.width=this.pageWidth+2*this.canvasPaddingHorizontal,this.canvas.height=this.pageHeight+2*this.canvasPaddingVeritical,this.canvas.style.top=-this.canvasPaddingVeritical+"px",this.canvas.style.left=-this.canvasPaddingHorizontal+"px",(this.pages||[]).forEach(function(e,i){i<t.pageIndex?(e.style.width="0px",t.flips[i].target=-1,t.flips[i].progress=-1):e.style.width=t.pageWidth+"px"})},t.prototype.initCanvas=function(){this.canvas=document.createElement("canvas"),this.book.insertBefore(this.canvas,this.book.childNodes[0]),this.canvas.style.position="absolute",this.canvas.style.zIndex="9999",this.canvasContext=this.canvas.getContext("2d"),this.canvas.width=this.pageWidth+2*this.canvasPaddingHorizontal,this.canvas.height=this.pageHeight+2*this.canvasPaddingVeritical,this.canvas.style.top=-this.canvasPaddingVeritical+"px",this.canvas.style.left=-this.canvasPaddingHorizontal+"px"},t.prototype.initFlips=function(){var t=this;this.flips=[],this.pages.forEach(function(e,i){var a=document.createElement("div");a.innerHTML=e.innerHTML,e.innerHTML="",e.appendChild(a),e.style.zIndex=(t.pages.length-i).toString(),e.style.position="absolute",e.style.left="0",e.style.right="0",e.style.top="0",e.style.bottom="0",t.flips.push({progress:1,target:1,page:e,pageWrapper:a,dragging:!1})})},t.prototype.initPages=function(){if(this.pages.length<=0)throw"please include at least one page";this.book.style.position="relative",this.initFlips(),this.pageWidth=this.pages[0].offsetWidth,this.pageHeight=this.pages[0].offsetHeight},t.prototype.init=function(){this.initPages(),this.initCanvas(),this.runRender(),this.bindEvent()},t}();e.default=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.LEFT="left",t.RIGHT="right"}(e.DirectionType||(e.DirectionType={})),function(t){t.SINGLE="single",t.DOUBLE="double"}(e.DisplayType||(e.DisplayType={}))}]);